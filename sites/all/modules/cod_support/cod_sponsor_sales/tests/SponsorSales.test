<?php
/**
 * @file
 * Unit test for cod_sponsorship_sales feature.
 */

class SponsorSalesTestCase extends DrupalWebTestCase {

  protected $entity;

  /**
   * Set up tests.
   */
  public function setUp() {
    $this->setup = TRUE;
  }

  /**
   * Overrides parent::tearDown().
   */
  public function tearDown() {
  }


  /**
   * Initialize.
   */
  public static function getInfo() {
    return array(
      'name' => 'Cod Sponsorship Sales.',
      'description' => 'Getting My Head Around Entities.',
      'group' => 'Cod',
    );
  }

  /**
   * Check that we have created a default sponsorship product.
   */
  public function testDefaultSponsorshipProduct() {
    $sponsorship = commerce_product_load_by_sku('sponsorship');
    $this->assertTrue((bool) $sponsorship, "A default sponsorship product has been created.");
  }

  /**
   * Check that the Authenticated User can create Sponsor nodes by default.
   */
  public function testAuthenticatedUserHasRights() {
    $sponsor_sales = new SponsorSales();
    $sponsor_sales->grantPerms();

    $authenticated_perms = user_role_permissions(array(DRUPAL_AUTHENTICATED_RID));
    $this->assertTrue(in_array('create sponsor content', $authenticated_perms),
      'The  authenticated user can create sponsor content.');
    $this->assertTrue(in_array('access checkout', $authenticated_perms),
      'The authenticated user has access to the commerce checkout system.');
  }
}
